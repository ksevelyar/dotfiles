(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{357:function(e,s,t){"use strict";t.r(s);var a=t(43),r=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"backup-with-rsync-and-dm-crypt"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#backup-with-rsync-and-dm-crypt"}},[e._v("#")]),e._v(" Backup with rsync and dm_crypt")]),e._v(" "),t("h2",{attrs:{id:"prepare-usb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prepare-usb"}},[e._v("#")]),e._v(" Prepare usb")]),e._v(" "),t("p",[e._v("Create 2 partitions, public "),t("code",[e._v("/sdx/sdx1")]),e._v(" and encrypted "),t("code",[e._v("/sdx/sdx2")]),e._v(".\nYou can do it with "),t("code",[e._v("gparted")]),e._v(" or "),t("code",[e._v("cfdisk")]),e._v(".")]),e._v(" "),t("h2",{attrs:{id:"encrypt-sdx2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#encrypt-sdx2"}},[e._v("#")]),e._v(" Encrypt sdx2")]),e._v(" "),t("div",{staticClass:"language-fish extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo cryptsetup luksFormat /dev/sdx2\nsudo cryptsetup config /dev/sdx2 --label secrets\n\ncryptsetup luksOpen /dev/sdx2 secrets\nsudo mkfs.ext4 -L secrets /dev/mapper/secrets\n")])])]),t("h2",{attrs:{id:"create-backup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-backup"}},[e._v("#")]),e._v(" Create backup")]),e._v(" "),t("div",{staticClass:"language-fish extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo chown ksevelyar:nobody /run/media/ksevelyar/secrets/\nrsync -ra --info=progress2 --delete --exclude-from=/etc/nixos/home/rsync-exclude.txt --delete ~ /run/media/ksevelyar/secrets\n")])])]),t("h2",{attrs:{id:"freeze-it-with-🐖🐖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#freeze-it-with-🐖🐖"}},[e._v("#")]),e._v(" Freeze it with 🐖🐖")]),e._v(" "),t("div",{staticClass:"language-fish extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("cd /run/media/ksevelyar/secrets\ntar cf - home | pigz > home-(date +'%m-%d-%Y').tar.xz\n\n")])])]),t("h2",{attrs:{id:"unmount-usb-drive"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#unmount-usb-drive"}},[e._v("#")]),e._v(" Unmount usb drive")]),e._v(" "),t("div",{staticClass:"language-fish extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo umount /dev/mapper/secrets\nsudo cryptsetup luksClose secrets\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);