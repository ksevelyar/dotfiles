(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{371:function(e,t,s){"use strict";s.r(t);var a=s(42),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"security"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#security"}},[e._v("#")]),e._v(" Security")]),e._v(" "),s("h2",{attrs:{id:"gpg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gpg"}},[e._v("#")]),e._v(" GPG")]),e._v(" "),s("h3",{attrs:{id:"create-template-for-your-keys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-template-for-your-keys"}},[e._v("#")]),e._v(" Create template for your keys")]),e._v(" "),s("p",[s("code",[e._v("nvim gpg.template")])]),e._v(" "),s("div",{staticClass:"language-conf extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Key-Type: eddsa\nKey-Curve: Ed25519\nKey-Usage: sign\nSubkey-Type: ecdh\nSubkey-Curve: Curve25519\nSubkey-Usage: encrypt\nName-Real: dude\nName-Email: dude@domain.tld\nExpire-Date: 0\n%commit\n")])])]),s("h3",{attrs:{id:"generate-a-ed25519-key"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generate-a-ed25519-key"}},[e._v("#")]),e._v(" Generate a Ed25519 key")]),e._v(" "),s("div",{staticClass:"language-fish extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("gpg --batch --generate-key gpg.template\n")])])]),s("h3",{attrs:{id:"enlist-keys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#enlist-keys"}},[e._v("#")]),e._v(" Enlist keys")]),e._v(" "),s("div",{staticClass:"language-fish extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("gpg --list-secret-keys\n")])])]),s("p",[e._v("You can use this key for pass now.")]),e._v(" "),s("h2",{attrs:{id:"gopass"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gopass"}},[e._v("#")]),e._v(" "),s("a",{attrs:{href:"https://woile.github.io/gopass-presentation/",target:"_blank",rel:"noopener noreferrer"}},[e._v("gopass"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("Aliased to "),s("code",[e._v("p")]),e._v(".")]),e._v(" "),s("h3",{attrs:{id:"init"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#init"}},[e._v("#")]),e._v(" Init")]),e._v(" "),s("p",[s("code",[e._v("gopass init <gpg-id>")])]),e._v(" "),s("h3",{attrs:{id:"generate-password-with-special-symbols-and-copy-it-to-clipboard"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generate-password-with-special-symbols-and-copy-it-to-clipboard"}},[e._v("#")]),e._v(" Generate password with special symbols and copy it to clipboard")]),e._v(" "),s("p",[s("code",[e._v("p generate -s mail/protonmail.com 80")])]),e._v(" "),s("h3",{attrs:{id:"import-your-passwords-to-pass"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#import-your-passwords-to-pass"}},[e._v("#")]),e._v(" Import your passwords to pass")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/roddhjav/pass-import#pass-import",target:"_blank",rel:"noopener noreferrer"}},[e._v("pass-import"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("You can use "),s("code",[e._v("gopass")]),e._v(" for fuzzy matchings (aliased to "),s("code",[e._v("p")]),e._v(") or GUI "),s("code",[e._v("qtpass")]),e._v(" (binded to "),s("code",[e._v("Win+p")]),e._v(").")]),e._v(" "),s("h2",{attrs:{id:"tomb"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomb"}},[e._v("#")]),e._v(" "),s("a",{attrs:{href:"https://www.dyne.org/software/tomb/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Tomb"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/dyne/Tomb/wiki/Quickstart",target:"_blank",rel:"noopener noreferrer"}},[e._v("Quickstart"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("To create a 100MB tomb:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" -p ~/.secrets "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" ~/.secrets\n\ntomb "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("dig")]),e._v(" -s "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v(" mrpoppybutthole.tomb\ntomb forge mrpoppybutthole.tomb.key\ntomb lock secret.tomb -k mrpoppybutthole.tomb.key\n")])])]),s("p",[e._v("To open it, do "),s("code",[e._v("tomb open mrpoppybutthole.tomb -k mrpoppybutthole.tomb.key")])]),e._v(" "),s("h2",{attrs:{id:"mount-ssh-and-password-store-from-tomb"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mount-ssh-and-password-store-from-tomb"}},[e._v("#")]),e._v(" "),s("a",{attrs:{href:"https://github.com/dyne/Tomb/wiki/Advancedfeatures",target:"_blank",rel:"noopener noreferrer"}},[e._v("Mount .ssh and .password-store from tomb"),s("OutboundLink")],1)]),e._v(" "),s("div",{staticClass:"language-fish extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cd /run/media/ksevelyar/mrpoppybutthole\nv bind-hooks\n")])])]),s("p",[e._v("Change content to:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v(".ssh            .ssh\n.password-store .password-store\n.gnupg          .gnupg\n")])])]),s("p",[e._v("and move this dirs to tomb.")]),e._v(" "),s("p",[e._v("Create empty folders:")]),e._v(" "),s("div",{staticClass:"language-fish extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("mkdir -p ~/.password-store ~/.gnupg ~/ssh\n")])])]),s("p",[e._v("Open tomb "),s("code",[e._v("tomb open mrpoppybutthole.tomb -k mrpoppybutthole.tomb.key")]),e._v(".")]),e._v(" "),s("p",[e._v("Done, now your ssh keys and passwords should be served from tomb.")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/dyne/Tomb/wiki/Advancedfeatures#hide-the-key",target:"_blank",rel:"noopener noreferrer"}},[e._v("Also, with tomb you can bury your key inside jpeg"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("Run "),s("code",[e._v("tomb close")]),e._v(" to unmount tomb.")]),e._v(" "),s("h2",{attrs:{id:"opened-ports"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#opened-ports"}},[e._v("#")]),e._v(" Opened ports")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/ksevelyar/idempotent-desktop/blob/mast../services/net/firewall-desktop.nix",target:"_blank",rel:"noopener noreferrer"}},[e._v("firewall-desktop"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"show-listening-ports"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#show-listening-ports"}},[e._v("#")]),e._v(" Show listening ports")]),e._v(" "),s("p",[s("code",[e._v("sudo lsof -Pni | grep -i listen")])]),e._v(" "),s("h2",{attrs:{id:"sshd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sshd"}},[e._v("#")]),e._v(" "),s("a",{attrs:{href:"https://github.com/ksevelyar/idempotent-desktop/blob/0c25763c040e5a50f393d2c2bb7c6eee616f37../services/common.nix#L9-L16",target:"_blank",rel:"noopener noreferrer"}},[e._v("sshd"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("Autostart disabled, use "),s("code",[e._v("sudo systemctl start sshd")])]),e._v(" "),s("p",[e._v("The port is 9922. Use "),s("code",[e._v('mosh --ssh="ssh -p 9922" user@host')]),e._v(" or legacy "),s("code",[e._v("ssh user@host -p 9922")]),e._v(" to connect.")]),e._v(" "),s("p",[e._v("In case your sshd is runninng you will see it in polybar with amount of active connects:")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://i.imgur.com/zZz3AfZ.png",alt:"polybar"}})]),e._v(" "),s("p",[e._v("The same for x11vnc.")]),e._v(" "),s("h3",{attrs:{id:"check-your-ssh-keys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#check-your-ssh-keys"}},[e._v("#")]),e._v(" Check your ssh keys")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("bash")]),e._v(" -c "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'for key in ~/.ssh/id_*; do ssh-keygen -l -f \""),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${key}")]),e._v("\"; done | uniq'")]),e._v("\n")])])]),s("blockquote",[s("p",[e._v("Today, the RSA is the most widely used public-key algorithm for SSH key. But compared to Ed25519, it’s slower and even considered not safe if it’s generated with the key smaller than 2048-bit length.")])]),e._v(" "),s("p",[s("a",{attrs:{href:"https://medium.com/risan/upgrade-your-ssh-key-to-ed25519-c6e8d60d3c54",target:"_blank",rel:"noopener noreferrer"}},[e._v("upgrade-your-ssh-key-to-ed25519"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("code",[e._v("ssh-keygen -o -a 100 -t ed25519 -f ~/.ssh/id_ed25519")])]),e._v(" "),s("h2",{attrs:{id:"fail2ban"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fail2ban"}},[e._v("#")]),e._v(" Fail2Ban")]),e._v(" "),s("p",[e._v("Currently integrated with "),s("code",[e._v("sshd")]),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"hardened-kernel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hardened-kernel"}},[e._v("#")]),e._v(" hardened kernel")]),e._v(" "),s("p",[e._v("You can switch to the hardened kernel with one line: "),s("a",{attrs:{href:"https://github.com/ksevelyar/idempotent-desktop/blob/504570d52ab79463704e4ddcf908f82c593621../sys/sysctl.nix#L4-L6",target:"_blank",rel:"noopener noreferrer"}},[e._v("sysctl.nix"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"monitor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#monitor"}},[e._v("#")]),e._v(" Monitor")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://haveibeenpwned.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("email"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);